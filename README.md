# Spext - Windows 语音输入工具

基于 OpenAI Whisper API 的 Windows 语音输入工具，支持全局热键录音并自动转换为文字输入。

## 功能特点

- 🎤 **全局热键录音**：按住热键即可开始录音，松开自动识别
- 🌐 **多语言支持**：完美支持中文输入，兼容微信、QQ、Telegram等各种应用
- 🔇 **智能静音**：录音时自动暂停系统其他音频，录音结束后恢复
- 📝 **即时输入**：识别完成后自动输入文字到当前光标位置
- 🔒 **安全存储**：API 密钥使用 Windows 凭据管理器安全存储

## 快速开始

1. 下载最新版本的 [Spext-v1.0.2-win-x64.zip](release/Spext-v1.0.2-win-x64.zip)
2. 解压并以管理员身份运行 `VoiceInput.exe`
3. 在设置中配置 OpenAI API 密钥
4. 按住热键（默认 F3）开始录音，松开后自动转换为文字

## 系统要求

- Windows 10 或更高版本
- 管理员权限
- OpenAI API 密钥

## 使用方法

### 语音输入
1. 将光标放置在需要输入文字的位置
2. 按住 `F3` 键开始录音
3. 说话完成后松开 `F3` 键
4. 等待识别完成，文字会自动输入

### 设置界面
- 右键点击系统托盘图标，选择"设置"
- **基本设置**：配置 API 密钥、热键、自动启动等
- **API 设置**：选择语音识别模型（支持最新的 GPT-4o 模型）
- **代理设置**：配置 HTTP 代理（支持认证）
- **界面设置**：调整界面主题和语言

## 更新日志

### v1.0.2 (2025-07-18)
- 🐛 修复 API 密钥丢失问题
- 🐛 修复中文输入兼容性问题
- 🐛 修复音频恢复时将音量设为0的Bug
- ✨ 新增对 OpenAI 最新语音识别模型的支持
- ✨ 品牌升级：VoiceInput 更名为 Spext

### v1.0.1
- 🐛 修复录音结束后将其他应用音量设为0的问题
- 🎨 全新的现代化设置界面
- 📊 新增录音时的实时音频频谱显示

### v1.0.0
- 初始版本发布

详细更新内容请查看 [release/v1.0.2/CHANGELOG.md](release/v1.0.2/CHANGELOG.md)

## 故障排除

### 常见问题

**Q: 中文输入在某些应用中不生效？**  
A: 程序会自动检测应用类型并选择最佳输入方式。如仍有问题，请提交 Issue。

**Q: API 密钥总是丢失？**  
A: 已在 v1.0.2 中修复。请确保使用最新版本。

**Q: 录音没有反应？**  
A: 1) 检查麦克风权限 2) 确保以管理员身份运行 3) 查看日志文件

**Q: 如何查看日志？**  
A: 日志位置：`%LOCALAPPDATA%\VoiceInput\Logs\`

## 开发说明

### 技术栈
- C# 9.0 + WPF (.NET Core 3.1)
- NAudio 2.2.1 - 音频处理
- ModernWpf - 现代化UI
- Windows API - 系统集成

### 项目结构
```
VoiceInput/
├── Core/               # 核心控制器
├── Services/           # 各类服务
├── Views/              # UI视图
└── Resources/          # 资源文件
```

详细开发文档请查看 [CLAUDE.md](CLAUDE.md)

## 许可证

MIT License

## 贡献指南

欢迎提交 Issue 和 Pull Request！