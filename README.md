# Spext - Windows 智能语音输入工具

基于 OpenAI Whisper API 的 Windows 语音输入工具，支持全局热键录音、智能校正和多语言翻译。

## ✨ 主要功能

- 🎤 **全局热键录音**：按住热键录音，松开自动转文字
- 🌍 **多语言支持**：支持中文、英文、日文等多种语言
- 🔄 **智能翻译**：一键语音输入并翻译成目标语言
- ✏️ **智能校正**：自动纠正错别字、同音字，添加标点符号
- 🎯 **多配置管理**：支持多个快捷键配置，适应不同场景
- 🔇 **智能静音**：录音时自动暂停其他音频
- 🔒 **安全存储**：API 密钥使用 Windows 凭据管理器安全存储

## 🚀 快速开始

1. 下载最新版本的 [Spext-v1.0.3-win-x64.zip](release/Spext-v1.0.3-win-x64.zip)
2. 解压并以管理员身份运行 `VoiceInput.exe`
3. 在设置中配置 OpenAI API 密钥
4. 按住快捷键开始使用

### 默认快捷键

- **F2**：纯语音转文字（默认启用）
- **F3**：中文智能校正（中英混合输入，智能纠错）
- **F4**：语音翻译成英文
- **F5**：语音翻译成日文

> 💡 F3-F5 需要在设置中手动启用

## 🎯 核心特性（2025年1月更新）

### 1. 智能中文校正（F3）
- 自动纠正错别字和同音字
- 智能添加标点符号
- **完美支持中英文混合输入**
- 保留英文单词不翻译（如 budget、meeting、review）
- 短语不会被自动扩展

### 2. 多配置管理系统
- 支持创建多个快捷键配置
- 每个配置可独立设置：
  - 输入语言（支持自动检测）
  - 输出语言（支持翻译）
  - 自定义提示词（转写/翻译分离）
- 支持配置导入/导出

### 3. 提示词定制
- 转写和翻译提示词分离设置
- 支持 2000 字符的复杂提示词
- 内置多种专业模板
- 实时字符计数提醒

## 💻 系统要求

- Windows 10 或更高版本
- 管理员权限（用于全局热键）
- OpenAI API 密钥

## 📖 使用指南

### 基础语音输入
1. 将光标定位到输入位置
2. 按住快捷键开始录音
3. 说话完成后松开
4. 等待识别完成，文字自动输入

### 高级功能设置
右键点击系统托盘图标，选择"设置"：
- **基本设置**：自动启动、录音选项
- **转写与翻译**：API密钥、模型选择、超时设置
- **快捷键配置**：管理多个快捷键方案
- **代理设置**：HTTP代理配置（支持认证）

## 🔧 故障排除

**问题：中文输入不正常？**
- 使用 F3 快捷键，它包含智能校正功能

**问题：英文单词被翻译成中文？**
- F3 配置已优化，会保留英文单词原样

**问题：API 请求失败？**
- 检查 API 密钥是否正确
- 检查网络连接和代理设置

**查看日志：** `%LOCALAPPDATA%\Spext\Logs\`

## 🛠️ 开发相关

### 技术栈
- C# 9.0 + WPF (.NET Core 3.1)
- NAudio 2.2.1（音频处理）
- OpenAI API（语音识别 + 翻译）
- Windows Credential Manager（安全存储）

### 项目结构
```
VoiceInput/
├── Core/                    # 核心控制器
├── Services/               # 服务层
│   ├── EnhancedSpeechRecognitionService  # 两阶段处理
│   ├── TranslationPromptTemplates        # 提示词模板
│   └── HotkeyProfileService             # 配置管理
├── Views/                  # UI 层
│   ├── Pages/             # 设置页面
│   └── Dialogs/           # 对话框
└── Models/                # 数据模型
```

详细开发文档：[CLAUDE.md](CLAUDE.md)

## 📝 更新日志

### v1.0.3 (2025-01-19)
- ✨ 新增多快捷键配置管理系统
- ✨ 新增智能中文校正功能（F3）
- ✨ 支持转写和翻译提示词分离
- ✨ 提示词长度提升至 2000 字符
- 🎨 设置界面宽度优化（1200px）
- 🐛 修复 API 密钥丢失问题
- 🐛 修复快捷键冲突检测问题

### v1.0.2 (2025-07-18)
- 🐛 修复 API 密钥丢失问题
- 🐛 修复中文输入兼容性
- ✨ 品牌升级为 Spext

### v1.0.1
- 🎨 全新现代化设置界面
- 📊 实时音频频谱显示

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

*Spext - 让语音输入更智能*