# 实施计划

## 第一阶段：项目初始化和基础架构

- [x] 1. 创建 .NET 8 WPF 项目
  - 创建解决方案和项目结构
  - 配置项目属性（单实例、图标等）
  - 添加必要的 NuGet 包引用
  - _需求: 基础架构_

- [x] 2. 实现系统托盘功能
  - 创建 NotifyIcon 托盘图标
  - 实现右键菜单（设置、退出）
  - 添加状态切换图标
  - _需求: 需求1_

- [x] 3. 实现单实例检查
  - 使用 Mutex 确保只运行一个实例
  - 已运行时激活现有实例
  - _需求: 需求1_

## 第二阶段：全局快捷键功能

- [x] 4. 实现全局快捷键注册
  - 使用 RegisterHotKey API
  - 默认注册 F3 键
  - 处理快捷键冲突
  - _需求: 需求2_

- [x] 5. 实现按键状态监听
  - 使用低级键盘钩子监听 KeyDown/KeyUp
  - 区分按下和释放事件
  - 防止重复触发
  - _需求: 需求2, 需求3_

## 第三阶段：音频录制功能

- [x] 6. 集成 NAudio 音频录制
  - 配置音频参数（16kHz, 16bit, 单声道）
  - 实现录音开始/停止
  - 内存流缓存音频数据
  - _需求: 需求3_

- [x] 7. 实现录音状态反馈
  - 托盘图标动画/变色
  - 录音中的视觉提示
  - 错误状态提示
  - _需求: 需求3_

## 第四阶段：语音识别集成

- [x] 8. 实现 OpenAI API 客户端
  - 配置 HttpClient
  - 实现 Whisper API 调用
  - 处理认证和请求头
  - _需求: 需求4_

- [x] 9. 实现音频上传和识别
  - WAV 格式封装
  - 异步上传音频
  - 解析识别结果
  - _需求: 需求4_

- [x] 10. 实现错误处理
  - 网络错误提示
  - API 错误处理
  - 超时重试机制
  - _需求: 需求4_

## 第五阶段：文字输入功能

- [x] 11. 实现键盘输入模拟
  - 集成 InputSimulator
  - 支持 Unicode 字符
  - 处理特殊字符
  - _需求: 需求5_

- [x] 12. 实现焦点检测和输入
  - 获取当前活动窗口
  - 检测输入焦点
  - 剪贴板备选方案
  - _需求: 需求5_

## 第六阶段：配置管理

- [x] 13. 实现配置存储
  - 创建配置类和接口
  - 实现 JSON 配置文件
  - 配置热重载
  - _需求: 需求6_

- [x] 14. 实现安全存储
  - 集成 Windows Credential Manager
  - API 密钥加密存储
  - 安全读写接口
  - _需求: 需求6_

- [x] 15. 创建设置界面
  - WPF 设置窗口设计
  - API 密钥配置页
  - 快捷键自定义
  - 开机启动选项
  - _需求: 需求6, 需求7_

## 第七阶段：开机启动功能

- [x] 16. 实现开机启动管理
  - 注册表操作
  - 默认启用开机启动
  - 设置界面集成
  - _需求: 需求7_

## 第八阶段：代理设置功能

- [x] 17. 实现代理配置管理
  - 添加代理配置项到配置文件
  - 实现代理设置的存储和读取
  - 支持代理认证信息的安全存储
  - _需求: 需求8_

- [x] 18. 更新设置界面
  - 添加代理设置选项卡
  - 实现启用/禁用代理复选框
  - 添加代理地址、端口输入框
  - 添加代理认证用户名密码输入
  - _需求: 需求8_

- [x] 19. 实现 HTTP 代理支持
  - 修改 HttpClient 配置支持代理
  - 实现代理认证处理
  - 添加代理连接测试功能
  - 处理代理相关错误
  - _需求: 需求8_

## 第九阶段：优化和打包

- [ ] 20. 性能优化
  - 内存池优化
  - 启动速度优化
  - 资源占用优化
  - _需求: 性能要求_

- [ ] 21. 创建安装程序
  - 配置发布参数
  - 使用 Inno Setup 创建安装程序
  - 代码签名（如有证书）
  - _需求: 部署要求_

## 第十阶段：测试和完善

- [ ] 22. 功能测试
  - 单元测试关键模块
  - 集成测试完整流程
  - 不同 Windows 版本测试
  - 代理功能测试
  - _需求: 所有需求_

- [ ] 23. 用户体验优化
  - 完善错误提示
  - 优化状态反馈
  - 添加使用说明
  - _需求: 用户体验_