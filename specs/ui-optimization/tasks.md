# 实施计划 - 界面UI优化

## 第一阶段：基础准备

- [x] 1. 安装ModernWpfUI NuGet包
  - 在VoiceInput.csproj中添加ModernWpfUI包引用
  - 更新项目依赖
  - _需求: 需求1_

- [x] 2. 创建资源目录结构
  - 创建Resources文件夹及子文件夹（Themes、Styles、Icons）
  - 创建基础资源字典文件
  - _需求: 需求1, 需求2_

- [x] 3. 设计并创建应用Logo
  - 创建VoiceInput的Logo设计（SVG格式）
  - 导出不同尺寸的PNG图标
  - 创建.ico文件用于应用图标
  - _需求: 需求2_

## 第二阶段：样式系统实现

- [x] 4. 实现主题系统
  - 创建LightTheme.xaml和DarkTheme.xaml
  - 实现主题切换机制
  - 在App.xaml中集成主题系统
  - _需求: 需求1_

- [x] 5. 创建现代化控件样式
  - 设计Button、TextBox、ComboBox等控件的现代化样式
  - 实现悬停、按下等交互效果
  - 添加过渡动画
  - _需求: 需求1_

## 第三阶段：设置窗口改造

- [x] 6. 重构设置窗口布局
  - 将TabControl改为侧边导航栏设计
  - 实现页面切换动画
  - 集成ModernWpfUI控件
  - _需求: 需求1_

- [x] 7. 添加Logo展示
  - 在设置窗口右下角添加Logo
  - 实现固定定位布局
  - 添加适当的透明度和大小
  - _需求: 需求2_

- [x] 8. 创建API设置页面
  - 设计API设置界面布局
  - 添加模型选择ComboBox
  - 添加超时时间输入控件
  - 添加API URL输入框
  - 实现输入验证
  - _需求: 需求5_

- [x] 9. 实现语言设置功能
  - 添加输入语言下拉框（自动检测、中文、英文等）
  - 添加输出模式选择（原语言转录、翻译成英文）
  - 添加说明文字和工具提示
  - _需求: 需求6_

- [x] 10. 创建界面设置页面
  - 添加主题切换选项
  - 添加波形显示开关
  - 添加波形相关配置
  - _需求: 需求4_

## 第四阶段：音频波形可视化

- [x] 11. 创建波形窗口基础结构 (已改为频谱显示)
  - 创建WaveformWindow.xaml
  - 实现透明背景和无边框窗口
  - 设置始终置顶和不获取焦点
  - _需求: 需求3_

- [x] 12. 实现音频数据处理
  - 在AudioRecorderService中添加音频数据事件
  - 实现FFT频谱分析
  - 创建音频数据缓冲机制
  - _需求: 需求3_

- [x] 13. 开发波形渲染引擎 (已改为频谱渲染)
  - 使用Canvas绘制波形
  - 实现平滑动画效果
  - 添加渐变色和视觉效果
  - 优化渲染性能
  - _需求: 需求3_

- [x] 14. 集成波形窗口控制
  - 在录音开始时显示波形窗口
  - 在录音结束时隐藏波形窗口
  - 根据设置控制是否显示
  - _需求: 需求3, 需求4_

## 第五阶段：配置系统扩展

- [x] 15. 扩展ConfigManager
  - 添加UI配置属性（主题、波形设置等）
  - 添加API高级参数属性
  - 添加语言设置属性
  - 实现配置保存和加载
  - _需求: 需求4, 需求5, 需求6_

- [x] 16. 更新配置文件结构
  - 在appsettings.json中添加新的配置节
  - 实现配置迁移（保持向后兼容）
  - 添加默认值处理
  - _需求: 需求4, 需求5, 需求6_

## 第六阶段：API服务更新

- [x] 17. 更新SpeechRecognitionService
  - 添加language参数支持
  - 实现transcription/translation模式切换
  - 添加新的API参数（temperature等）
  - _需求: 需求5, 需求6_

- [x] 18. 实现API调用优化
  - 根据语言设置优化请求参数
  - 添加更详细的错误处理
  - 实现请求日志记录
  - _需求: 需求5, 需求6_

## 第七阶段：系统集成和优化

- [x] 19. 更新系统托盘图标
  - 使用新设计的应用图标
  - 优化托盘菜单样式
  - _需求: 需求2_

- [x] 20. 性能优化
  - 优化波形渲染性能
  - 实现资源缓存
  - 减少内存占用
  - _需求: 需求3_

- [x] 21. 测试和调试
  - 测试所有新功能
  - 验证不同DPI设置下的显示效果
  - 确保向后兼容性
  - 修复发现的问题
  - _需求: 所有需求_

## 第八阶段：文档和发布

- [ ] 22. 更新用户文档
  - 更新README说明新功能
  - 创建UI使用指南
  - 添加配置说明
  - _需求: 所有需求_

- [ ] 23. 准备发布
  - 更新版本号
  - 创建发布说明
  - 构建发布包
  - _需求: 所有需求_

## 实施优先级说明

1. **高优先级**：基础准备、样式系统、设置窗口改造
2. **中优先级**：音频波形可视化、配置系统扩展
3. **低优先级**：系统集成优化、文档更新

每个任务完成后都需要进行代码审查和测试，确保功能正常且不影响现有功能。